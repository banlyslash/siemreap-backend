# Root schema file
scalar DateTime

type Query {
  # User queries
  me: User
  users: [User!]!
  user(id: ID!): User

  # Leave type queries
  leaveTypes: [LeaveType!]!
  leaveType(id: ID!): LeaveType

  # Leave request queries
  leaveRequests(
    status: LeaveRequestStatus
    userId: ID
    startDate: DateTime
    endDate: DateTime
  ): [LeaveRequest!]!
  leaveRequest(id: ID!): LeaveRequest
  
  # Leave history queries
  leaveHistory(
    userId: ID
    leaveTypeId: ID
    status: LeaveRequestStatus
    startDate: DateTime
    endDate: DateTime
    sortBy: LeaveHistorySortField
    sortDirection: SortDirection
    page: Int
    pageSize: Int
  ): LeaveHistoryResult!
  
  # Export leave history
  exportLeaveHistory(
    userId: ID
    leaveTypeId: ID
    status: LeaveRequestStatus
    startDate: DateTime
    endDate: DateTime
    format: ExportFormat!
  ): ExportResult!
  
  # Leave audit trail
  leaveAuditTrail(leaveRequestId: ID!): [LeaveAuditEntry!]!
  
  # Leave approval dashboard queries
  pendingApprovals: [LeaveRequest!]! # For managers and HR to see pending requests that need approval
  managerApprovedRequests: [LeaveRequest!]! # For HR to see requests approved by managers

  # Leave balance queries
  leaveBalances(userId: ID, year: Int): [LeaveBalance!]!
  leaveBalance(id: ID!): LeaveBalance
  userLeaveBalances(userId: ID!, year: Int): UserLeaveBalances!

  # Team queries
  teamMembers(managerId: ID!): [User!]!
  teamOnLeaveToday(managerId: ID!): [LeaveRequest!]!

  # Holiday queries
  holidays(year: Int): [Holiday!]!
  holiday(id: ID!): Holiday
}

type Mutation {
  # Auth mutations
  login(email: String!, password: String!): AuthPayload!
  
  # User mutations
  createUser(input: CreateUserInput!): User!
  updateUser(id: ID!, input: UpdateUserInput!): User!
  
  # Leave request mutations
  createLeaveRequest(input: CreateLeaveRequestInput!): LeaveRequest!
  updateLeaveRequest(id: ID!, input: UpdateLeaveRequestInput!): LeaveRequest!
  approveLeaveRequest(id: ID!, comment: String): LeaveRequest!
  rejectLeaveRequest(id: ID!, comment: String!): LeaveRequest!
  cancelLeaveRequest(id: ID!): LeaveRequest!
  
  # Role-specific approval mutations (for frontend compatibility)
  managerApproveLeaveRequest(id: ID!, comment: String): LeaveRequest!
  managerRejectLeaveRequest(id: ID!, comment: String!): LeaveRequest!
  hrApproveLeaveRequest(id: ID!, comment: String): LeaveRequest!
  hrRejectLeaveRequest(id: ID!, comment: String!): LeaveRequest!
  
  # Leave type mutations
  createLeaveType(input: CreateLeaveTypeInput!): LeaveType!
  updateLeaveType(id: ID!, input: UpdateLeaveTypeInput!): LeaveType!
  
  # Leave balance mutations
  updateLeaveBalance(id: ID!, input: UpdateLeaveBalanceInput!): LeaveBalance!
  initializeLeaveBalance(input: InitializeLeaveBalanceInput!): InitializeLeaveBalanceResult!
  
  # Holiday mutations
  createHoliday(input: CreateHolidayInput!): Holiday!
  updateHoliday(id: ID!, input: UpdateHolidayInput!): Holiday!
  deleteHoliday(id: ID!): Boolean!
}

# Auth types
type AuthPayload {
  token: String!
  user: User!
}
